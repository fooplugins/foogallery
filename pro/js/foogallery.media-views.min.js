/*
* FooGallery Media Views - Video import component for FooGallery
* @version 0.0.9
* @link 
* @copyright Steven Usher & Brad Vincent 2015
* @license Released under the GPLv3 license.
*/
wp.foogallery=function(e){var t;return"select"===(e=_.defaults(e||{},{frame:"select"})).frame&&wp.foogallery.Select?(t=new wp.foogallery.Select(e),delete e.frame,wp.media.frame=t):"select-child"===e.frame&&wp.foogallery.ChildSelect?(t=new wp.foogallery.ChildSelect(e),delete e.frame,wp.media.frame=t):wp.media.apply(this,arguments)},wp.foogallery.media={},wp.foogallery.frames={},wp.foogallery.debug=!1,(e=>{wp.foogallery.l10n={tabs:{upload:e&&_.isString(e.uploadFilesTitle)?e.uploadFilesTitle:"Upload Files",browse:e&&_.isString(e.mediaLibraryTitle)?e.mediaLibraryTitle:"Media Library",import:"Import Videos"},toolbar:{back:"Back",import:"Import",loadMore:"Load More Results"},errorTitle:"An Error Occurred",errors:{unknown:"An unknown error has occurred.",unexpectedResponse:"Unexpected response.",requestAborted:"Request aborted.",invalidAttachment:"The selected attachment does not have the required information available.",required:"Required.",pattern:"Regular expression failed.",importNoVideos:"No videos supplied for import."},compatibility:{supported:"Supported.",mobileSafariWebM:"Requires VP8 codec used in WebRTC."},import:{cancel:"Cancel",cancelling:"Cancelling",cancelled:"Cancelled",complete:"Complete",fetching:"Fetching next page...",importing:"Importing {start} to {end} of {total} - {percent}%"}},wp.foogallery.format_l10n=function(e,t,i){var o=Array.prototype.slice.call(arguments);if(e=o.shift(),_.isString(e)&&0!==o.length)for(var s in o=1===o.length&&(_.isArray(o[0])||_.isObject(o[0]))?o[0]:o)o.hasOwnProperty(s)&&(e=e.replace(new RegExp("\\{"+s+"\\}","gi"),o[s]));return e}})(wp.media.view.l10n),(a=>{var e,i,s={devices:{desktop:{name:"Desktop",browsers:{ie:"Internet Explorer 9-11",edge:"Edge",chrome:"Chrome",firefox:"Firefox",opera:"Opera",safari:"Safari"}},mobile:{name:"Mobile",browsers:{chrome:"Chrome for Android",firefox:"Firefox for Android",opera:"Opera Mobile",safari:"iOS Safari",uc:"UC Browser for Android",samsung:"Samsung Internet"}}},types:{webm:{name:"WebM",aliases:["webm","video/webm"],browsers:{desktop:{ie:!1,edge:!0,firefox:!0,chrome:!0,opera:!0,safari:!0},mobile:{firefox:!0,chrome:!0,opera:!0,safari:a.compatibility.mobileSafariWebM,uc:!0,samsung:!0}}},ogg:{name:"Ogg",aliases:["ogg","video/ogg","ogv","video/ogv"],browsers:{desktop:{ie:!1,edge:!0,firefox:!0,chrome:!0,opera:!0,safari:!1},mobile:{firefox:!0,chrome:!1,opera:!1,safari:!1,uc:!0,samsung:!1}}},mp4:{name:"MP4",aliases:["mp4","video/mp4"],browsers:{desktop:{ie:!0,edge:!0,firefox:!0,chrome:!0,opera:!0,safari:!0},mobile:{firefox:!0,chrome:!0,opera:!0,safari:!0,uc:!0,samsung:!0}}}}},r=(e=s.types,i={},_.each(e,function(e,t){_.each(e.aliases,function(e){i[e]=t})}),i);wp.foogallery.compatibility=function(e){o={},_.each(s.devices,function(e,i){o[i]={title:e.name,browsers:{}},_.each(e.browsers,function(e,t){o[i].browsers[t]={title:e,value:-1}})});var o,t=o;return _.each((e=e,_.isArray(e)?(e=_.map(e,function(e){e=r[e];return s.types.hasOwnProperty(e)?s.types[e]:null}),_.compact(e)):[]),function(s){_.each(s.browsers,function(o,e){_.each(t[e].browsers,function(e,t){var i=-1===e.title.indexOf("\n\n")?"\n\n":"\n",t=o[t];_.isString(t)?(t=[s.name,t].join(" - "),e.title=[e.title,t].join(i),e.value=1===e.value?1:0):!0===t&&(t=[s.name,a.compatibility.supported].join(" - "),e.title=[e.title,t].join(i),e.value=1)})})}),t}})(wp.foogallery.l10n),(()=>{function d(e,t,i){""===t?_.isArray(e)&&e.push(i):_.isUndefined(e[t])?e[t]=i:(_.isArray(e[t])||(e[t]=[e[t]]),e[t].push(i))}wp.foogallery.formJSON=function(e,t){t=_.isString(t)?t:":input:not(:button)";var p={},e=e.find(t).serializeArray();return _.each(e,function(e){var t,i,o,s;if(-1<e.name.indexOf("["))for(var a=p,r=e.name.replace(/]/gi,"").split("["),n=0,l=r.length;n<l;n++){var c=r[n],h=r[n+1];n==l-1?d(a,c,e.value):(t=a,h=h,s=o=i=void 0,a=""===(c=c)&&_.isArray(t)&&h?(o=(i=t.length)-1,s={},0<i&&t[o]&&(_.isUndefined(t[o][h])||_.isArray(t[o][h]))?s=t[o]:t.push(s),s):t[c]=t[c]||(isNaN(h)&&""!==h?{}:[]))}else d(p,e.name,e.value)}),p}})(jQuery),(()=>{var e=wp.media.View.extend({initialize:function(){this.mediaFrame=this.options.mediaFrame||!1,_.defaults(this.options,{region:"",mode:"default",persist:!0}),this.activated=!1,this.once("ready",this._ready,this)},remove:function(e){return this._deactivate(),this.options.persist&&!e?this:wp.media.View.prototype.remove.apply(this,arguments)},_ready:function(){this._activate(),this.controller.off(this.options.region+":activate:"+this.options.mode).off(this.options.region+":deactivate:"+this.options.mode).on(this.options.region+":activate:"+this.options.mode,this._activate,this).on(this.options.region+":deactivate:"+this.options.mode,this._deactivate,this)},_activate:function(){this.activated||(this.activated=!0,this.activate())},_deactivate:function(){this.activated&&(this.activated=!1,this.deactivate())},activate:function(){},deactivate:function(){}});wp.foogallery.media.View=e})(),(e=>{var t=e.extend({initialize:function(){e.prototype.initialize.apply(this,arguments),_.defaults(this.options,{data:{}}),this.data=_.defaults(this.options.data,{timestamp:(new Date).getTime()})},prepare:function(){return this.data},compare:function(e){return!_.isObject(e)||!_.isNumber(e.timestamp)||e.timestamp<this.data.timestamp?-1:e.timestamp>this.data.timestamp?1:0}});wp.foogallery.media.DataView=t})(wp.foogallery.media.View),(()=>{var e=wp.media.controller.Region.extend({mode:function(e,t){return e?(t=_.isObject(t)?t:{},this.trigger("deactivate",e,t),this._mode=e,this.render(e,t),this.trigger("activate",e,t),this):this._mode},render:function(e,t){if(e&&e!==this._mode)return this.mode(e,t);t=_.isObject(t)?t:{};var i={view:null};return this.trigger("create",i,e,t),this.trigger("render",i=i.view,e,t),i&&this.set(i),this}});wp.foogallery.media.Region=e})(),((n,l,c)=>{var e=n.extend({regions:{},initialize:function(){!this.options.mediaFrame&&this.controller instanceof wp.foogallery.Select&&(this.options.mediaFrame=this.controller),n.prototype.initialize.apply(this,arguments),_.defaults(this.options,{defaultRegion:"content",defaultMode:"default"}),this._regions={},this._views={},this._createRegions()},_createRegions:function(){_.each(_.keys(this.regions),function(e){this[e]=new c({mediaFrame:this.mediaFrame,view:this,id:e,selector:this.regions[e]}),this._regions[e]=this._regions[e]||this.options[e]||"default"},this)},activate:function(){_.each(_.keys(this.regions),function(e){this[e].mode()!=this._regions[e]?this[e].mode(this._regions[e]):this.trigger(e+":activate:"+this._regions[e])},this),this.controller instanceof wp.media.view.Frame&&this.controller.activateMode(this.options.mode)},deactivate:function(){_.each(_.keys(this.regions),function(e){this._regions[e]=this[e].mode(),this.trigger(e+":deactivate:"+this._regions[e])},this),this.controller instanceof wp.media.view.Frame&&this.controller.deactivateMode(this.options.mode)},getMode:function(e){var t=null;return this[e]instanceof c&&(t=this[e].mode(),this._regions[e]=t),t},setMode:function(e,t,i){this[e]instanceof c&&(this[e].mode(t,i),this._regions[e]=t)},regionMode:function(e,t,i){if(_.isString(e)&&this[e]instanceof c){if(!_.isString(t))return this._regions[e]=this[e].mode();this[e].mode(t,i),this._regions[e]=t}},getView:function(e,t){_.defaults(e,{mediaFrame:this.mediaFrame,controller:this,region:this.options.defaultRegion,mode:this.options.defaultMode,data:{}});var i,o,s,a=e.region+"_",r=null;return t?(a+=e.mode,i=(r=this._views[a])instanceof n,o=!(r instanceof t),s=r instanceof l&&0!=r.compare(e.data),(o||s)&&(i&&r.remove(!0),this._views[a]=r=new t(e))):this[e.region]instanceof c&&(a+=this[e.region].mode(),r=this._views.hasOwnProperty(a)?this._views[a]:null),r}});wp.foogallery.media.Frame=e})(wp.foogallery.media.View,wp.foogallery.media.DataView,wp.foogallery.media.Region),((e,t)=>{var i=e.Select.extend({initialize:function(){_.defaults(this.options,{frame:"select",multiple:!1,resetOnOpen:!0,content:"browse",persistState:!0}),e.Select.prototype.initialize.apply(this,arguments),this.on("select",this._select,this),this.on("open",this._open,this),this.on("close",this._close,this)},createStates:function(){var e=this.options;e.states||this.states.add([new wp.media.controller.Library({library:wp.media.query(e.library),multiple:e.multiple,title:e.title,priority:20,contentUserSetting:e.persistState,syncSelection:e.persistState})])},_select:function(){var e=this.state().get("selection").toJSON();this.trigger("selected",this.options.multiple?e:_.first(e))},_open:function(){var e;this.options.resetOnOpen&&(e=this.state().get("selection"))&&e.reset(),"upload"==this.content.mode()&&this.content.mode(this.options.content),this.controller&&this.controller.$el.parents(".media-modal:first").parent().hide()},_close:function(){this.controller&&(t("body").addClass("modal-open"),this.controller.$el.parents(".media-modal:first").parent().show())}});wp.foogallery.media.Select=i})(wp.media.view.MediaFrame,jQuery),((t,e)=>{var i=e.extend({initialize:function(){_.defaults(this.options,{frame:"select-import",persistState:!1}),e.prototype.initialize.apply(this,arguments),wp.foogallery.debug&&this.on("all",function(e){console.log("Select\t\t\t"+e,Array.prototype.slice.call(arguments))}),this.importer=new wp.foogallery.frames.Importer({controller:this}),this.on("content:render:import",this.renderImport,this)},createSelectToolbar:function(e,t){(t=t||this.options.button||{}).controller=this,e.view=new i.Toolbar(t)},browseRouter:function(e){e.set({upload:{text:t.tabs.upload,priority:20},browse:{text:t.tabs.browse,priority:40},import:{text:t.tabs.import,priority:50}})},renderImport:function(){this.content.set(this.importer)},toggleMode:function(e,t){(_.isUndefined(t)?!this.isModeActive(e):t)?this.activateMode(e):this.deactivateMode(e)}});wp.foogallery.Select=i})(wp.foogallery.l10n,wp.foogallery.media.Select),((t,o)=>{var e=o.extend({initialize:function(){var e=this.options;_.bindAll(this,"clickImport","clickBack"),e.items=_.defaults(e.items||{},{import:{style:"primary",text:t.toolbar.import,priority:10,click:this.clickImport,requires:{mode:"importable"}},back:{style:"secondary",text:t.toolbar.back,priority:20,click:this.clickBack,requires:{mode:"backable"}}}),o.prototype.initialize.apply(this,arguments),this.bindModes()},refresh:function(){o.prototype.refresh.apply(this,arguments);var i=this.controller;_.each(this._views,function(e){var t;e.model&&e.options&&e.options.requires&&(t=e.options.requires).mode&&e.model.set("disabled",!i.isModeActive(t.mode))})},bindModes:function(){var e=_.map(this.options.items,function(e){return e.requires&&e.requires.mode?e.requires.mode:null});(e=_.uniq(_.compact(e))).length&&(e=_.map(e,function(e){return[e+":activate",e+":deactivate"]}),e=_.flatten(e),this.controller.on(e.join(" "),this.refresh,this))},clickImport:function(){this.controller.state().trigger("toolbar:button:import")},clickBack:function(){this.controller.state().trigger("toolbar:button:back")}});wp.foogallery.Select.Toolbar=e})(wp.foogallery.l10n,wp.media.view.Toolbar.Select),(e=>{var t=e.extend({initialize:function(){_.defaults(this.options,{frame:"select-child",persistState:!1}),e.prototype.initialize.apply(this,arguments)}});wp.foogallery.ChildSelect=t})(wp.foogallery.Select),((a,e,t)=>{var i="fgi_query",r="fgi_nonce",o=e.extend({tagName:"div",className:"fgi",template:wp.template("fg-importer"),regions:{query:".fgi-region-query",help:".fgi-region-help",content:".fgi-region-content"},initialize:function(){_.defaults(this.options,{mediaFrame:this.controller,region:"content",mode:"import",query:"default",help:"default",content:"getting-started",mimeTypes:["video/mp4","video/webm","video/ogv"]}),e.prototype.initialize.apply(this,arguments),this._request=null,this._history=[],this._first=!1,this._content={error:o.Error,"getting-started":o.GettingStarted,"self-hosted":o.Query.SelfHosted,oembed:o.Query.oEmbed,"json-result":o.Query.JSONResult,search:o.Query.Result,single:o.Query.Result,embed:o.Query.Result,vimeo:o.Query.Vimeo,youtube:o.Query.YouTube,album:o.Query.Album,channel:o.Query.Channel,playlistItems:o.Query.Playlist,user:o.Query.User,import:o.Import,"import-result":o.Import.Result},wp.foogallery.debug&&this.on("all",function(e){console.log("Importer\t\t"+e,Array.prototype.slice.call(arguments))}),this.mediaFrame.on("toolbar:button:back",this.back,this),this.on("query:create:default",this.createQuery,this),this.on("help:create:default",this.createHelp,this),this.on("content:create",this.createContent,this),this.on("content:render",this.renderContent,this)},activate:function(){this._first&&(this._first=!1,this.mediaFrame.activateMode("help")),e.prototype.activate.apply(this,arguments)},back:function(){this._history.pop();var e,t=this._history.pop();this.regionMode("content",t.mode,t.data),_.isObject(t.data)&&(e=this.getView({region:"query"}))&&e.set(_.isString(t.data.query)?t.data.query:"")},createQuery:function(e){e.view=this.getView({region:"query"},o.Query)},createHelp:function(e){e.view=this.getView({region:"help"},o.Help)},createContent:function(e,t,i){this._content[t]?e.view=this.getView({mode:t,data:i},this._content[t]):e.view=this.getView({mode:t,data:i},this._content["json-result"])},renderContent:function(e,t,i){this._history.push({mode:t,data:i}),i&&!0===i.reset&&(t=this._history.pop(),this._history.splice(0,this._history.length),this._history.push(t),t=this.getView({region:"query"}))&&t.set(_.isString(i.query)?i.query:""),this.mediaFrame.toggleMode("backable",1<this._history.length),this.mediaFrame.deactivateMode("importable"),this.content.set(e)},contentMode:function(e,t){return this.regionMode("content",e,t)},ajax:function(e){var s=this;return t.Deferred(function(o){(e=_.defaults(e||{},{action:i}))[r]=s.$("."+r).val(),s._request&&s._request.abort(),s.trigger("request:start",e),s._request=t.ajax({type:"POST",url:ajaxurl,data:e,success:function(e){s.trigger("request:success request:end"),e&&e.success&&e.data&&e.data.mode?"error"===e.data.mode?o.reject(e.data):(e.data.timestamp=(new Date).getTime(),o.resolve(e.data)):o.reject({mode:"error",message:a.errors.unexpectedResponse})},error:function(e,t,i){s.trigger("request:error request:end"),"abort"===t?o.reject({mode:"abort",message:a.errors.requestAborted}):o.reject({mode:"error",message:i})}})}).promise()},ajax_query:function(e){return this.ajax(_.defaults(e||{},{action:i}))},ajax_import:function(e){return this.ajax(_.defaults(e||{},{action:"fgi_import"}))},ajax_save:function(e){return this.ajax(_.defaults(e||{},{action:"fgi_save"}))}});wp.foogallery.frames.Importer=o})(wp.foogallery.l10n,wp.foogallery.media.Frame,jQuery),((e,t)=>{var i=t.extend({tagName:"div",className:"fgi-error",template:wp.template("fgi-error"),namespace:".fgi-error",sel:{ok:".fgi-ok"},initialize:function(){t.prototype.initialize.apply(this,arguments),_.defaults(this.data,{title:e.errorTitle,message:e.errors.unknown})},activate:function(){this.$(this.sel.ok).on("click"+this.namespace,_.bind(this.onOkClick,this))},deactivate:function(){this.$(this.sel.ok).off(this.namespace)},onOkClick:function(e){e.preventDefault(),this.controller.contentMode("getting-started",{reset:!0})}});wp.foogallery.frames.Importer.Error=i})(wp.foogallery.l10n,wp.foogallery.media.DataView),((e,t)=>{e=e.extend({tagName:"div",className:"fgi-help",template:wp.template("fgi-help"),namespace:".fgi-help",sel:{title:".fgi-provider-title",content:".fgi-provider-content"},activate:function(){this.$(this.sel.title).on("click"+this.namespace,_.bind(this.onProviderTitleClick,this))},deactivate:function(){this.$(this.sel.title).off(this.namespace)},onProviderTitleClick:function(e){e.preventDefault(),t(e.target).next(this.sel.content).addBack().toggleClass("mode-expanded")}}),wp.foogallery.frames.Importer.Help=e})(wp.foogallery.media.View,jQuery),((i,e,t)=>{var o=e.extend({tagName:"div",className:"fgi-getting-started",template:wp.template("fgi-getting-started"),namespace:".fgi-getting-started",sel:{help:'[href="#toggle-help"]',select:".fgi-select"},initialize:function(){e.prototype.initialize.apply(this,arguments),this._select=null},activate:function(){this.$(this.sel.help).on("click"+this.namespace,_.bind(this.onHelpClick,this)),this.$(this.sel.select).on("click"+this.namespace,_.bind(this.onSelectClick,this))},deactivate:function(){this.$(this.sel.help).off(this.namespace),this.$(this.sel.select).off(this.namespace)},onHelpClick:function(e){e.preventDefault(),this.mediaFrame.toggleMode("help")},onSelectClick:function(e){e.preventDefault(),this._select instanceof wp.media.view.MediaFrame.Select?this._select.open():(e=t(e.target).data("options"),this._select=wp.foogallery({controller:this,title:e.title,button:{text:e.button},library:{type:e.type}}).on("selected",function(e){e=this.attachmentToSelfHosted(e);this.controller.contentMode(e.mode,e)},this).open())},attachmentToSelfHosted:function(e){if(_.isObject(e)&&_.isString(e.filename)&&-1!==(t=e.filename.lastIndexOf("."))){var t={mode:"self-hosted",id:e.filename.substr(0,t)||"",title:e.title||"",description:e.description||"",thumbnail:"",urls:{mp4:"",ogg:"",webm:""}};if(e.subtype&&""===t.urls[e.subtype])return t.urls[e.subtype]=e.url||t.urls[e.subtype],t}return{mode:"error",message:i.errors.invalidAttachment}}});wp.foogallery.frames.Importer.GettingStarted=o})(wp.foogallery.l10n,wp.foogallery.media.View,jQuery),((e,t)=>{var i=e.extend({tagName:"div",className:"fgi-query",template:wp.template("fgi-query"),namespace:".fgi-query",sel:{input:".fgi-query-input",help:'[href="#toggle-help"]'},initialize:function(){e.prototype.initialize.apply(this,arguments),this.controller.on("request:start",this.requestStart,this),this.controller.on("request:end",this.requestEnd,this)},activate:function(){this.$(this.sel.input).on("keypress"+this.namespace+" paste"+this.namespace,_.debounce(_.bind(this.onInputChange,this),500)).on("keydown"+this.namespace,_.debounce(_.bind(this.onInputKeydown,this),500)).focus(),this.$(this.sel.help).on("click"+this.namespace,_.bind(this.onHelpClick,this))},deactivate:function(){this.$(this.sel.input).off(this.namespace),this.$(this.sel.help).off(this.namespace)},set:function(e){this.$(this.sel.input).val(e)},get:function(){return this.$(this.sel.input).val()},query:function(e){e=_.isString(e)?e:this.get();var t=this.controller;return t.ajax_query({query:e,page:1,offset:0}).then(function(e){t.contentMode(e.mode,e)},function(e){e&&"abort"===e.mode||t.contentMode(e.mode,e)})},requestStart:function(){this.$el.addClass("mode-requesting")},requestEnd:function(){this.$el.removeClass("mode-requesting")},onInputChange:function(e){this.handleChange(e.target)},onInputKeydown:function(e){_.contains([8],e.which)&&this.handleChange(e.target)},onHelpClick:function(e){e.preventDefault(),this.mediaFrame.toggleMode("help")},handleChange:function(e){e=t(e).val();null!==e&&"string"==typeof e&&3<=e.length&&this.query(e)}});wp.foogallery.frames.Importer.Query=i})(wp.foogallery.media.View,jQuery),((d,t,m)=>{var e=t.extend({tagName:"div",className:"fgi-self-hosted",template:wp.template("fgi-self-hosted"),template_compatibility:wp.template("fgi-compatibility"),namespace:".fgi-self-hosted",sel:{form:".fgi-form",row:".fgi-row",col_input:".fgi-col-input",browse:".fgi-browse",browse_button:".fgi-browse-col-button button",browse_input:".fgi-browse-col-input input",compatibility:".fgi-video-compatibility",validate:'input[name="thumbnail"],input[name^="urls"]'},initialize:function(){t.prototype.initialize.apply(this,arguments),_.defaults(this.data,{mode:"",id:"",thumbnail:"",title:"",description:"",urls:{mp4:"",ogg:"",webm:""},types:{mp4:{pattern:"mp4",text:".mp4",mime:"video/mp4"},ogg:{pattern:"ogv|ogg",text:".ogv or .ogg",mime:"video/ogv,video/ogg"},webm:{pattern:"webm",text:".webm",mime:"video/webm"}}}),this._select={}},render:function(){var e=t.prototype.render.apply(this,arguments);return this.compatibility(),e},activate:function(){this.mediaFrame.on("toolbar:button:import",this.import,this),this.$(this.sel.browse_button).on("click"+this.namespace,_.bind(this.onBrowseClick,this)),this.$(this.sel.validate).on("keypress"+this.namespace+" paste"+this.namespace+" change"+this.namespace,_.debounce(_.bind(this.onValidateChange,this),500)).on("keydown"+this.namespace,_.debounce(_.bind(this.onValidateKeydown,this),500))},deactivate:function(){this.mediaFrame.off("toolbar:button:import",this.import,this),this.$(this.sel.browse_button).off(this.namespace),this.$(this.sel.validate).off(this.namespace)},compatibility:function(){var e;this.template_compatibility&&(e=this.$('input[name^="urls["]').map(function(){var e=m(this),t=e.val(),e=e.data("type");return _.isString(t)&&""!=t?e:null}).get(),e=wp.foogallery.compatibility(e),this.$(this.sel.compatibility).html(this.template_compatibility(e)))},onBrowseClick:function(e){e.preventDefault();var t=this,i=m(e.target),e=i.data("options");this._select[e.type]instanceof wp.media.view.MediaFrame.Select?this._select[e.type].open():this._select[e.type]=wp.foogallery({frame:"select-child",mode:"browse",controller:this,title:e.title,button:{text:e.button},library:{type:e.type}}).on("selected",function(e){e=i.parents(t.sel.browse).find(t.sel.browse_input).val(e.url);t.validateChange(e)}).open()},onValidateChange:function(e){this.validateChange(e.target)},onValidateKeydown:function(e){_.contains([8],e.which)&&this.validateChange(e.target)},validateChange:function(e){var e=m(e),t=this.validateInput(e,!0);return t&&e.is('[name^="urls["]')&&this.compatibility(),t=t&&this.validateForm(),this.mediaFrame.toggleMode("importable",t),t},validateForm:function(e){for(var t=this.$(this.sel.validate),i=!0,o=0,s=t.length;o<s;o++)this.validateInput(t.eq(o),e)||(i=!1);return i},validateInput:function(e,t){var i,e=m(e),o=!0;return 0<(i=this._validate(e)).length?(o=!1,1==t&&(t=m.map(i,function(e){return m("<p/>",{class:"fgi-input-error",text:e})}),e.parents(this.sel.row).addClass("mode-error"),e.parents([this.sel.browse,this.sel.col_input].join(",")).first().find(".fgi-input-error").remove().end().append(t))):(e.parents(this.sel.row).removeClass("mode-error"),e.parents([this.sel.browse,this.sel.col_input].join(",")).first().find(".fgi-input-error").remove()),o},_validate:function(e){var t,e=m(e),i=e.val(),o=e.data("required"),s=_.isString(i)&&""!==i,a=this._regex(e.data("pattern")),r=e.data("messages")||{},n=[];if(o&&!s)if(_.isString(o)&&0<(t=this.$(o).not(e)).length){for(var l,c=!1,h=0,p=t.length;h<p;h++)l=t.eq(h).val(),_.isString(l)&&""!==l&&(c=!0);c||n.push((_.isString(r.required)?r:d.errors).required)}else n.push((_.isString(r.required)?r:d.errors).required);return a&&s&&!a.test(i)&&n.push((_.isString(r.pattern)?r:d.errors).pattern),n},_regex:function(e){if(!_.isString(e)||""===e)return null;try{return new RegExp(e,"i")}catch(e){return null}},import:function(){var e;this.validateForm(!0)&&(e=wp.foogallery.formJSON(this.$(this.sel.form)),this.controller.contentMode("import",{mode:"self-hosted",total:1,videos:[e]}))}});wp.foogallery.frames.Importer.Query.SelfHosted=e})(wp.foogallery.l10n,wp.foogallery.media.DataView,jQuery),((t,i)=>{var e=t.extend({tagName:"div",className:"fgi-json-result",render:function(){var e;return this.template?t.prototype.render.apply(this,arguments):(e=this.prepare(),this.views.detach(),this.$el.html(i("<pre/>",{text:JSON.stringify(e,null,2)})),this.views.render(),this)}});wp.foogallery.frames.Importer.Query.JSONResult=e})(wp.foogallery.media.DataView,jQuery),((e,o)=>{var t=e.extend({tagName:"div",className:"fgi-query-result",template:wp.template("fgi-query-result"),template_notification:wp.template("fgi-query-result-notification"),template_items:wp.template("fgi-query-result-items"),template_status:wp.template("fgi-query-result-status"),namespace:".fgi-query-result",sel:{notification:".fgi-query-result-notification",list:".fgi-query-result-list",status:".fgi-query-result-status",check:".fgi-query-result-video-check",thumbnail:".fgi-query-result-video-thumbnail",paged:".fgi-query-result-paged",loadMore:'[href="#load-more"]',tryAgain:'[href="#try-again"]',offset:".fgi-query-result-offset",total:".fgi-query-result-total"},initialize:function(){e.prototype.initialize.apply(this,arguments),_.defaults(this.data,{total:1,page:1,nextPage:0,offset:0,videos:[]})},render:function(){var e;return this.prepare&&(e=this.prepare()),this.views.detach(),this.template&&(this.trigger("prepare",e=e||{}),this.$el.html(this.template(e)).toggleClass("mode-single",this.data.total<=1),this.template_notification&&this.$(this.sel.notification).html(this.template_notification(e)),this.template_items&&this.$(this.sel.list).html(this.template_items(e)),this.template_status)&&this.$(this.sel.status).html(this.template_status(e)),this.views.render(),this},activate:function(){this.mediaFrame.toggleMode("importable",this.hasSelection()),this.mediaFrame.on("toolbar:button:import",this.import,this),this.$(this.sel.list).on("click"+this.namespace,this.sel.check,_.bind(this.onCheckClick,this)).on("click"+this.namespace,this.sel.thumbnail,_.bind(this.onThumbnailClick,this)),this.$el.on("click"+this.namespace,this.sel.loadMore,_.bind(this.onLoadMoreClick,this)),this.$el.on("click"+this.namespace,this.sel.tryAgain,_.bind(this.onLoadMoreClick,this))},deactivate:function(){this.mediaFrame.off("toolbar:button:import",this.import,this),this.$(this.sel.list).off(this.namespace),this.$el.off(this.namespace)},onThumbnailClick:function(e){e.preventDefault(),this.$(this.sel.list).children(".mode-current").removeClass("mode-current"),o(e.target).parents("li:first").addClass("mode-selected mode-current"),this.mediaFrame.toggleMode("importable",this.hasSelection())},onCheckClick:function(e){e.preventDefault(),e.stopPropagation(),o(e.target).parents("li:first").removeClass("mode-selected mode-current"),this.mediaFrame.toggleMode("importable",this.hasSelection())},hasSelection:function(){return 0<this.$(this.sel.list).children(".mode-selected").length},selection:function(){var i=this;return this.$(this.sel.list).children(".mode-selected").map(function(e,t){return _.find(i.data.videos,function(e){return e.id===o(t).attr("data-id")})}).get()},loadMore:function(){var e=this.data,i=this,o=i.$(i.sel.status).removeClass("mode-error").addClass("mode-loading");return this.controller.ajax_query({query:e.query,page:e.nextPage,offset:e.offset}).then(function(e){var t=i.template_items(e);i.$(i.sel.list).append(t),e.videos=i.data.videos.concat(e.videos),i.data=i.options.data=e,t=i.template_status(e),o.removeClass("mode-loading mode-error").html(t)},function(){o.removeClass("mode-loading").addClass("mode-error")})},onLoadMoreClick:function(e){e.preventDefault(),this.loadMore()},import:function(){var e=this.selection();this.controller.contentMode("import",{mode:"selection",total:e.length,videos:e})}});wp.foogallery.frames.Importer.Query.Result=t})(wp.foogallery.media.DataView,jQuery),(e=>{var t=e.extend({template_notification:wp.template("fgi-album-notification"),namespace:".fgi-album",activate:function(){this.$('[href="#import-album"]').on("click"+this.namespace,_.bind(this.onImportAlbumClick,this)),e.prototype.activate.apply(this,arguments)},deactivate:function(){this.$('[href="#import-album"]').off(this.namespace),e.prototype.deactivate.apply(this,arguments)},onImportAlbumClick:function(e){e.preventDefault(),this.controller.contentMode("import",this.data)}});wp.foogallery.frames.Importer.Query.Album=t})(wp.foogallery.frames.Importer.Query.Result),(e=>{var t=e.extend({template_notification:wp.template("fgi-channel-notification"),namespace:".fgi-channel",activate:function(){this.$('[href="#import-channel"]').on("click"+this.namespace,_.bind(this.onImportChannelClick,this)),e.prototype.activate.apply(this,arguments)},deactivate:function(){this.$('[href="#import-channel"]').off(this.namespace),e.prototype.deactivate.apply(this,arguments)},onImportChannelClick:function(e){e.preventDefault(),this.controller.contentMode("import",this.data)}});wp.foogallery.frames.Importer.Query.Channel=t})(wp.foogallery.frames.Importer.Query.Result),(e=>{var t=e.extend({template_notification:wp.template("fgi-playlist-notification"),namespace:".fgi-playlist",activate:function(){this.$('[href="#import-playlist"]').on("click"+this.namespace,_.bind(this.onImportPlaylistClick,this)),e.prototype.activate.apply(this,arguments)},deactivate:function(){this.$('[href="#import-playlist"]').off(this.namespace),e.prototype.deactivate.apply(this,arguments)},onImportPlaylistClick:function(e){e.preventDefault(),this.controller.contentMode("import",this.data)}});wp.foogallery.frames.Importer.Query.Playlist=t})(wp.foogallery.frames.Importer.Query.Result),(e=>{var t=e.extend({template_notification:wp.template("fgi-user-notification"),namespace:".fgi-user",activate:function(){this.$('[href="#import-user"]').on("click"+this.namespace,_.bind(this.onImportUserClick,this)),e.prototype.activate.apply(this,arguments)},deactivate:function(){this.$('[href="#import-user"]').off(this.namespace),e.prototype.deactivate.apply(this,arguments)},onImportUserClick:function(e){e.preventDefault(),this.controller.contentMode("import",this.data)}});wp.foogallery.frames.Importer.Query.User=t})(wp.foogallery.frames.Importer.Query.Result),((d,e,m)=>{var t=e.extend({tagName:"div",className:"fgi-oembed",template:wp.template("fgi-oembed"),namespace:".fgi-oembed",sel:{form:".fgi-form",row:".fgi-row",col_input:".fgi-col-input",browse:".fgi-browse",browse_button:".fgi-browse-col-button button",browse_input:".fgi-browse-col-input input",compatibility:".fgi-video-compatibility",validate:'input[name="thumbnail"]'},initialize:function(){e.prototype.initialize.apply(this,arguments),_.defaults(this.data,{mode:"",id:"",provider:"",thumbnail:"",title:"",description:""}),this._select={}},activate:function(){this.mediaFrame.on("toolbar:button:import",this.import,this),this.$(this.sel.browse_button).on("click"+this.namespace,_.bind(this.onBrowseClick,this)),this.$(this.sel.validate).on("keypress"+this.namespace+" paste"+this.namespace+" change"+this.namespace,_.debounce(_.bind(this.onValidateChange,this),500)).on("keydown"+this.namespace,_.debounce(_.bind(this.onValidateKeydown,this),500))},deactivate:function(){this.mediaFrame.off("toolbar:button:import",this.import,this),this.$(this.sel.browse_button).off(this.namespace),this.$(this.sel.validate).off(this.namespace)},onBrowseClick:function(e){e.preventDefault();var t=this,i=m(e.target),e=i.data("options");this._select[e.type]instanceof wp.media.view.MediaFrame.Select?this._select[e.type].open():this._select[e.type]=wp.foogallery({frame:"select-child",mode:"browse",controller:this,title:e.title,button:{text:e.button},library:{type:e.type}}).on("selected",function(e){e=i.parents(t.sel.browse).find(t.sel.browse_input).val(e.url);t.validateChange(e)}).open()},onValidateChange:function(e){this.validateChange(e.target)},onValidateKeydown:function(e){_.contains([8],e.which)&&this.validateChange(e.target)},validateChange:function(e){e=m(e),e=(e=this.validateInput(e,!0))&&this.validateForm();return this.mediaFrame.toggleMode("importable",e),e},validateForm:function(e){for(var t=this.$(this.sel.validate),i=!0,o=0,s=t.length;o<s;o++)this.validateInput(t.eq(o),e)||(i=!1);return i},validateInput:function(e,t){var i,e=m(e),o=!0;return 0<(i=this._validate(e)).length?(o=!1,1==t&&(t=m.map(i,function(e){return m("<p/>",{class:"fgi-input-error",text:e})}),e.parents(this.sel.row).addClass("mode-error"),e.parents([this.sel.browse,this.sel.col_input].join(",")).first().find(".fgi-input-error").remove().end().append(t))):(e.parents(this.sel.row).removeClass("mode-error"),e.parents([this.sel.browse,this.sel.col_input].join(",")).first().find(".fgi-input-error").remove()),o},_validate:function(e){var t,e=m(e),i=e.val(),o=e.data("required"),s=_.isString(i)&&""!==i,a=this._regex(e.data("pattern")),r=e.data("messages")||{},n=[];if(o&&!s)if(_.isString(o)&&0<(t=this.$(o).not(e)).length){for(var l,c=!1,h=0,p=t.length;h<p;h++)l=t.eq(h).val(),_.isString(l)&&""!==l&&(c=!0);c||n.push((_.isString(r.required)?r:d.errors).required)}else n.push((_.isString(r.required)?r:d.errors).required);return a&&s&&!a.test(i)&&n.push((_.isString(r.pattern)?r:d.errors).pattern),n},_regex:function(e){if(!_.isString(e)||""===e)return null;try{return new RegExp(e,"i")}catch(e){return null}},import:function(){var e;this.validateForm(!0)&&(e=wp.foogallery.formJSON(this.$(this.sel.form)),this.controller.contentMode("import",{mode:"embed",total:1,videos:[e]}))}});wp.foogallery.frames.Importer.Query.oEmbed=t})(wp.foogallery.l10n,wp.foogallery.media.DataView,jQuery),((e,t)=>{var i=e.extend({tagName:"div",className:"fgi-vimeo",template:wp.template("fgi-vimeo"),namespace:".fgi-vimeo",sel:{access_token:"input[name='access_token']",save:".fgi-save",help:'[href="#toggle-help"]',container:".button-hero-container",error:".fgi-vimeo-error-message"},cls:{error:"fgi-vimeo-error"},initialize:function(){e.prototype.initialize.apply(this,arguments),_.defaults(this.data,{mode:"",access_token:"",query:""})},activate:function(){this.$(this.sel.help).on("click"+this.namespace,_.bind(this.onHelpClick,this)),this.$(this.sel.save).on("click"+this.namespace,_.bind(this.onSaveClick,this)),this.$(this.sel.access_token).on("keypress"+this.namespace+" paste"+this.namespace+" change"+this.namespace,_.debounce(_.bind(this.onValidateChange,this),500)).on("keydown"+this.namespace,_.debounce(_.bind(this.onValidateKeydown,this),500))},deactivate:function(){this.$(this.sel.save).off(this.namespace),this.$(this.sel.access_token).off(this.namespace)},onValidateChange:function(e){this.validateChange(e.target)},onValidateKeydown:function(e){_.contains([8],e.which)&&this.validateChange(e.target)},validateChange:function(e){e=t(e).val(),e=_.isString(e)&&30<=e.length;return this.$(this.sel.save).attr("disabled",!e),this.$(this.sel.container).removeClass(this.cls.error),this.$(this.sel.error).empty(),e},onHelpClick:function(e){e.preventDefault(),this.mediaFrame.toggleMode("help")},onSaveClick:function(e){e.preventDefault(),this.save()},save:function(){var t,i,e=this.$(this.sel.access_token).val();if(_.isString(e)&&30<=e.length)return i=(t=this).controller,t.$(t.sel.save).attr("disabled",!0),i.ajax_save({access_token:e,action:"fgi_save_vimeo_access_token"}).then(function(){var e=i.getView({region:"query"});e instanceof wp.foogallery.frames.Importer.Query&&e.query(t.data.query)},function(e){e&&"abort"===e.mode||(t.$(t.sel.error).html(e.message),t.$(t.sel.container).addClass(t.cls.error))})}});wp.foogallery.frames.Importer.Query.Vimeo=i})((wp.foogallery.l10n,wp.foogallery.media.DataView),jQuery),((e,t)=>{var i=e.extend({tagName:"div",className:"fgi-youtube",template:wp.template("fgi-youtube"),namespace:".fgi-youtube",sel:{api_key:"input[name='api_key']",save:".fgi-save",help:'[href="#toggle-help"]',container:".button-hero-container",error:".fgi-youtube-error-message"},cls:{error:"fgi-youtube-error"},initialize:function(){e.prototype.initialize.apply(this,arguments),_.defaults(this.data,{mode:"",api_key:"",query:""})},activate:function(){this.$(this.sel.help).on("click"+this.namespace,_.bind(this.onHelpClick,this)),this.$(this.sel.save).on("click"+this.namespace,_.bind(this.onSaveClick,this)),this.$(this.sel.api_key).on("keypress"+this.namespace+" paste"+this.namespace+" change"+this.namespace,_.debounce(_.bind(this.onValidateChange,this),500)).on("keydown"+this.namespace,_.debounce(_.bind(this.onValidateKeydown,this),500))},deactivate:function(){this.$(this.sel.save).off(this.namespace),this.$(this.sel.api_key).off(this.namespace)},onValidateChange:function(e){this.validateChange(e.target)},onValidateKeydown:function(e){_.contains([8],e.which)&&this.validateChange(e.target)},validateChange:function(e){e=t(e).val(),e=_.isString(e)&&30<=e.length;return this.$(this.sel.save).attr("disabled",!e),this.$(this.sel.container).removeClass(this.cls.error),this.$(this.sel.error).empty(),e},onHelpClick:function(e){e.preventDefault(),this.mediaFrame.toggleMode("help")},onSaveClick:function(e){e.preventDefault(),this.save()},save:function(){var t,i,e=this.$(this.sel.api_key).val();if(_.isString(e)&&30<=e.length)return i=(t=this).controller,t.$(t.sel.save).attr("disabled",!0),i.ajax_save({api_key:e,action:"fgi_save_youtube_api_key"}).then(function(){var e=i.getView({region:"query"});e instanceof wp.foogallery.frames.Importer.Query&&e.query(t.data.query)},function(e){e&&"abort"===e.mode||(t.$(t.sel.error).html(e.message),t.$(t.sel.container).addClass(t.cls.error))})}});wp.foogallery.frames.Importer.Query.YouTube=i})((wp.foogallery.l10n,wp.foogallery.media.DataView),jQuery),((m,t,f)=>{var e=t.extend({tagName:"div",className:"fgi-import",template:wp.template("fgi-import"),namespace:".fgi-import",sel:{yes:".fgi-import-yes",back:".fgi-import-back",cancel:".fgi-import-cancel",progress_value:".fgi-import-progress-value",progress_text:".fgi-import-progress-text"},initialize:function(){t.prototype.initialize.apply(this,arguments),_.defaults(this.data,{total:0,videos:[]}),this.max=10,this.cancelling=!1,this._result={imported:[],failed:[],errors:[],cancelled:[]},this._start=-1,this._end=-1,this.once("ready",this.onceReady,this)},onceReady:function(){this.skipConfirm()&&this.do_import().then(_.bind(this.checkResult,this),function(e){console.log(e)})},remove:function(e){return this.$el.removeClass("mode-importing"),t.prototype.remove.apply(this,arguments)},activate:function(){this.$(this.sel.yes).on("click"+this.namespace,_.bind(this.onYesClick,this)),this.$(this.sel.back).on("click"+this.namespace,_.bind(this.onBackClick,this)),this.$(this.sel.cancel).on("click"+this.namespace,_.bind(this.onCancelClick,this))},deactivate:function(){this.$(this.sel.yes).off(this.namespace),this.$(this.sel.back).off(this.namespace),this.$(this.sel.cancel).off(this.namespace)},onBackClick:function(e){e.preventDefault(),this.controller.back()},onYesClick:function(e){e.preventDefault(),this.do_import().then(_.bind(this.checkResult,this),function(e){console.log(e)})},onCancelClick:function(e){e.preventDefault(),this.setCancelling(!0)},setCancelling:function(e){(this.cancelling=e)?this.$(this.sel.cancel).attr("disabled","disabled").text(m.import.cancelling):this.$(this.sel.cancel).removeAttr("disabled").text(m.import.cancel)},skipConfirm:function(){return _.isNumber(this.data.total)&&this.data.total<=this.max},hasNextPage:function(){return this.data.hasOwnProperty("nextPage")&&0!==this.data.nextPage},do_import:function(e){var t,i,o,s,a,r,n,l,c,h=this,p=this.data,d=[];return _.isArray(p.videos)&&0<p.videos.length?(h.$el.addClass("mode-importing"),h.mediaFrame.deactivateMode("backable"),t=p.videos.length,e?(h._start=h._end+1,h._end+=t):(h._start=1,h._end=t),p.videos.length>h.max?(i=[],o=0,_.each(p.videos,function(e){++o>h.max&&(d.push(i),o=1,i=[]),i.push(e)}),0<i.length&&d.push(i)):d=_.map(p.videos,function(e){return[e]}),s=d.length,a=[],r=[],n=[],l=[],e=f.Deferred(),c=e.promise(),_.each(d,function(e,t){c=c.then(function(){if(!h.cancelling)return h.controller.ajax_import({videos:e}).then(function(e){Array.prototype.push.apply(a,e.imported),Array.prototype.push.apply(r,e.failed),Array.prototype.push.apply(n,e.errors),h.progressed(t+1,s)});Array.prototype.push.apply(l,e)})}),c=c.then(function(){var e=0===a.length?"failed":0<r.length?"mixed":"completed";return h.cancelling&&(e="cancelled"),h.setCancelling(!1),{state:e,imported:a,failed:r,errors:n,cancelled:l}}),h.progressed(0,s),e.resolve(),c):f.Deferred().reject({mode:"error",message:m.errors.importNoVideos}).promise()},checkResult:function(e){var t;Array.prototype.push.apply(this._result.imported,e.imported),Array.prototype.push.apply(this._result.failed,e.failed),Array.prototype.push.apply(this._result.errors,e.errors),Array.prototype.push.apply(this._result.cancelled,e.cancelled),"cancelled"===e.state?(this.setProgress(0,m.import.cancelled),this.cancelled(this._result),this._result={imported:[],failed:[],errors:[],cancelled:[]}):this.hasNextPage()?((t=this).setProgress(0,m.import.fetching),this.controller.ajax_query({query:this.data.query,page:this.data.nextPage,offset:this.data.offset}).then(function(e){t.data=e,t.do_import(!0).then(_.bind(t.checkResult,t),function(e){console.log(e)})})):(this.completed(this._result),this._result={imported:[],failed:[],errors:[],cancelled:[]})},setProgress:function(e,t){_.isString(t)||(t=e+"%"),this.$(this.sel.progress_text).text(t),this.$(this.sel.progress_value).css("width",e+"%")},progressed:function(e,t){wp.foogallery.debug&&console.log("progressed",e,t);var i,e=Math.round(e/t*100*100)/100,t=this.data;100==e?i=m.import.complete:this.hasNextPage()&&(i=wp.foogallery.format_l10n(m.import.importing,{start:this._start,end:this._end,total:t.total,percent:e})),this.setProgress(e,i)},completed:function(e){_.defaults(e,{reset:!0}),wp.foogallery.debug&&console.log("completed",e),this.$el.removeClass("mode-importing"),this.controller.contentMode("import-result",e),"import"!==this.mediaFrame.content.mode()&&this.mediaFrame.content.mode("import")},cancelled:function(e){_.defaults(e,{reset:!0}),wp.foogallery.debug&&console.log("cancelled",e),this.$el.removeClass("mode-importing"),this.controller.contentMode("import-result",e),"import"!==this.mediaFrame.content.mode()&&this.mediaFrame.content.mode("import")}});wp.foogallery.frames.Importer.Import=e})(wp.foogallery.l10n,wp.foogallery.media.DataView,jQuery),(i=>{var e=i.extend({tagName:"div",className:"fgi-import-result",template:wp.template("fgi-import-result"),namespace:".fgi-import-result",sel:{toggle_failed:'[href="#toggle-failed"]',toggle_cancelled:'[href="#toggle-cancelled"]',try_again_failed:'[href="#try-again-failed"]',import_cancelled:'[href="#import-cancelled"]',failed_list:".fgi-import-failed",cancelled_list:".fgi-import-cancelled",more_videos:".fgi-import-more-videos",add_videos:".fgi-import-add-videos",media_library:'[href="#media-library"]'},initialize:function(){var e,t;i.prototype.initialize.apply(this,arguments),_.defaults(this.data,{imported:[],failed:[],errors:[],cancelled:[]}),0<this.data.imported.length&&(e=(t=this.mediaFrame.state()).get("library"),t=t.get("selection"),e.props.set({ignore:+new Date}),this.loadMore(e,t))},activate:function(){this.$(this.sel.toggle_failed).on("click"+this.namespace,_.bind(this.onToggleFailedClick,this)),this.$(this.sel.toggle_cancelled).on("click"+this.namespace,_.bind(this.onToggleCancelledClick,this)),this.$(this.sel.try_again_failed).on("click"+this.namespace,_.bind(this.onTryAgainFailedClick,this)),this.$(this.sel.import_cancelled).on("click"+this.namespace,_.bind(this.onImportCancelledClick,this)),this.$(this.sel.more_videos).on("click"+this.namespace,_.bind(this.onImportMoreVideosClick,this)),this.$(this.sel.add_videos).on("click"+this.namespace,_.bind(this.onImportAddVideosClick,this)),this.$(this.sel.media_library).on("click"+this.namespace,_.bind(this.onMediaLibraryClick,this))},deactivate:function(){this.$(this.sel.toggle_failed).off(this.namespace),this.$(this.sel.toggle_cancelled).off(this.namespace),this.$(this.sel.try_again_failed).off(this.namespace),this.$(this.sel.import_cancelled).off(this.namespace),this.$(this.sel.more_videos).off(this.namespace),this.$(this.sel.add_videos).off(this.namespace),this.$(this.sel.media_library).off(this.namespace)},loadMore:function(t,i){var o=this;t.more().then(function(){var e;t.models.length<o.data.imported.length?o.loadMore(t,i):0<(e=_.filter(t.models,function(e){e=e.get("id");return-1!==_.indexOf(o.data.imported,e)})).length&&i.add(e)})},onToggleFailedClick:function(e){e.preventDefault(),this.$(this.sel.failed_list).toggleClass("mode-expanded")},onToggleCancelledClick:function(e){e.preventDefault(),this.$(this.sel.cancelled_list).toggleClass("mode-expanded")},onTryAgainFailedClick:function(e){e.preventDefault(),this.controller.contentMode("import",{mode:"retry",total:this.data.failed.length,videos:this.data.failed})},onImportCancelledClick:function(e){e.preventDefault(),this.controller.contentMode("import",{mode:"retry",total:this.data.cancelled.length,videos:this.data.cancelled})},onImportMoreVideosClick:function(e){e.preventDefault(),this.controller.contentMode("getting-started",{reset:!0})},onImportAddVideosClick:function(e){e.preventDefault(),this.controller.contentMode("getting-started",{reset:!0}),this.mediaFrame.content.mode("browse"),this.mediaFrame.$(".media-button-select").click()},onMediaLibraryClick:function(e){e.preventDefault(),this.mediaFrame.content.mode("browse")}});wp.foogallery.frames.Importer.Import.Result=e})(wp.foogallery.media.DataView);