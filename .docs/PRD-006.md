# PRD-006: Gate Override Thumbnail Removal

## Issue Summary
The override thumbnail removal AJAX handler only verifies a nonce and does not check attachment edit capability. This can allow unauthorized removal of override thumbnails.

## Affected Endpoint
- `foogallery_remove_alternate_img` in `includes/class-override-thumbnail.php`

## Risk/Impact
- Unauthorized modification of attachment metadata.

## Recommended Fix
1. After nonce verification, enforce `current_user_can( 'edit_post', $img_id )`.
2. Validate `img_id` with `absint` and early return on invalid values.
3. Use `wp_send_json_error` / `wp_send_json_success` responses.

## Files/Functions
- `includes/class-override-thumbnail.php`
  - `ajax_remove_override()`

## Acceptance Criteria
- Only users who can edit the attachment can remove the override thumbnail.
- If responses switch to `wp_send_json_success`/`wp_send_json_error`, confirm the initiating JavaScript handler still parses the response correctly.

## Test Plan
- Add `WP_Ajax_UnitTestCase` coverage for `foogallery_remove_alternate_img`.
- Assert subscriber gets 403 even with valid nonce.
- Assert editor with `edit_post` succeeds.

## Final Cleanup
- After tests pass and the fix is complete, ask the user whether to delete this PRD and include the deletion in the final commit.
